<!DOCTYPE html>
<html lang="cs" data-ng-app="app">
<head>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, minimum-scale=1.0">
   <title>Examiner</title>
   <meta name="description" content="">
   <link href="humans.txt" type="text/plain" rel="author">
   <link href="css/default.min.css" rel="stylesheet">
   <link href="//fonts.googleapis.com" rel="dns-prefetch">
   <link href="//fonts.googleapis.com/css?family=PT+Sans:400,400italic&amp;subset=latin,latin-ext" rel="stylesheet">
   <link href="//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet">
   <link href="//fonts.googleapis.com/css?family=Oswald:300&amp;subset=latin,latin-ext" rel="stylesheet">
   <link href="//fonts.googleapis.com/css?family=Roboto:300,400,400italic&amp;subset=latin,latin-ext" rel="stylesheet">
   <!--[if lte IE 9]><script src="js/shims.min.js"></script><![endif]-->
   <script src="js/app.min.js"></script>
</head>
<body>

<div class="layout-wrapper">

   <header class="page-header">

      <h1 class="site-logo"><a href=""></a></h1>

      <nav class="top-nav">
         <ul class="inline-list">
            <li>Logged in as &ndash; <a href="">havelad1</a></li>
            <li><a href="">Preferences</a></li>
            <li><a href="">Log Out</a></li>
         </ul>
      </nav>

      <span class="time">1:56</span>

   </header>

   <aside class="sidebar">

      <nav class="site-nav">
         <ul class="block-list">
            <li><a class="site-nav__item icon--write" href="">Current</a></li>
            <li><a class="ng-active site-nav__item icon--tick" href="">Evaluate</a></li>
            <li><a class="site-nav__item icon--exams" href="">Browse</a></li>
            <li><a class="site-nav__item icon--create" href="">Create</a></li>
            <li><a class="site-nav__item icon--results" href="">Results</a></li>
         </ul>
      </nav>

   </aside>

   <section class="main-content" role="main">

      <article class="exam">

         <h1 class="alpha heading exam__heading">MI-MDW &mdash; 10. 3. 2014</h1>

         <aside class="exam__contents">
            <ol class="block-list">
               <li>
                  <a class="active" href="#section-a">Section A</a>
                  <ol class="block-list">
                     <li><a class="ng-done" href="#question-a-1" >Question A.1</a></li>
                     <li><a class="ng-active" href="#question-a-2">Question A.2</a></li>
                     <li><a href="#question-a-1">Question A.3</a></li>
                     <li><a href="#question-a-2">Question A.4</a></li>
                  </ol>
               </li>
               <li>
                  <a href="#section-a">Section B</a>
                  <ol class="block-list">
                     <li><a href="#question-a-1">Question B.1</a></li>
                     <li><a href="#question-a-2">Question B.2</a></li>
                  </ol>
               </li>
            </ol>
         </aside>

         <p class="lede">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Esse, eligendi, consequuntur, in, itaque placeat vel perferendis at porro eaque odio ullam repellat ipsa beatae ducimus fugiat quis aliquam culpa praesentium.</p>

         <section class="exam__section" id="section-a">

            <h1 class="beta heading heading--section">
               Section A
            </h1>

            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Iure, animi assumenda ea velit voluptatem numquam dolore architecto magni ratione. Earum aut incidunt maxime eum exercitationem sed cupiditate ex expedita voluptas!</p>

            <article class="question" id="question-a-1">

               <h1 class="delta heading heading--subsection question__heading">
                  Question A.1
                  <span class="question__points">5 points</span>
               </h1>

               <p>Necessitatibus, quidem, saepe aspernatur velit consequuntur provident nostrum qui ratione ipsum eum rerum blanditiis itaque praesentium eius fugiat voluptates tempora. Perspiciatis, vitae temporibus natus itaque ipsam reprehenderit corporis veniam quia.</p>

               <pre><code class="language-javascript">var src = f.src.filter(function(filepath) {
   // Warn on and remove invalid source files (if nonull was set).
   if (!grunt.file.exists(filepath)) {
      grunt.log.warn('Source file "' + filepath + '" not found.');
      return false;
   } else {
      return true;
   }
}).map(function(filepath) {
  // Read file source.
  return grunt.file.read(filepath);
});</code></pre>

               <h2 class="epsilon heading heading--caption">Your answer</h2>
               <p class="question__answer" contenteditable spellcheck="false" placeholder="Type here..."></p>

            </article>

            <article class="question" id="question-a-2">

               <h1 class="delta heading heading--subsection">
                  Question A.2
                  <span class="question__points">5 points</span>
               </h1>

               <p>Accusantium, quas tempora hic suscipit animi temporibus aperiam velit eos esse iusto nemo alias sequi nesciunt nobis pariatur ipsa reprehenderit labore ipsum provident voluptates assumenda perspiciatis quis repellat voluptas voluptatum.</p>

               <p>Necessitatibus, quidem, saepe aspernatur velit consequuntur provident nostrum qui ratione ipsum eum rerum blanditiis itaque praesentium eius fugiat voluptates tempora. Perspiciatis, vitae temporibus natus itaque ipsam reprehenderit corporis veniam quia.</p>

               <h2 class="epsilon heading heading--caption">Your answer</h2>
               <pre class="question__answer j-code" contenteditable spellcheck="false"><code class="language-javascript">var src = f.src.filter(function(filepath) {
   // Warn on and remove invalid source files (if nonull was set).
   if (!grunt.file.exists(filepath)) {
      grunt.log.warn('Source file "' + filepath + '" not found.');
      return false;
   } else {
      return true;
   }
}).map(function(filepath) {
  // Read file source.
  return grunt.file.read(filepath);
});</code></pre>


            </article>

         </section>

         <section class="exam__section" id="section-b">

            <h1 class="beta heading heading--section">
               Section B
            </h1>

            <p>Necessitatibus, quidem, saepe aspernatur velit consequuntur provident nostrum qui ratione ipsum eum rerum blanditiis itaque praesentium eius fugiat voluptates tempora. Perspiciatis, vitae temporibus natus itaque ipsam reprehenderit corporis veniam quia.</p>

            <article class="question" id="question-b-1">

               <h1 class="delta heading heading--subsection question__heading">
                  Question B.1
                  <span class="question__points">5 points</span>
               </h1>

               <p>Necessitatibus, quidem, saepe aspernatur velit consequuntur provident nostrum qui ratione ipsum eum rerum blanditiis itaque praesentium eius fugiat voluptates tempora. Perspiciatis, vitae temporibus natus itaque ipsam reprehenderit corporis veniam quia.</p>

               <h2 class="epsilon heading heading--caption">Your answer</h2>
               <div class="canvas j-canvas">
                  <canvas id="question-b-1-answer" class="question__answer"></canvas>
                  <ul class="inline-list tools">
                     <li><button class="tools__item icon--arrow j-canvas-tool j-canvas-select"></button></li>
                     <li><button class="tools__item icon--paint j-canvas-tool j-canvas-paint"></button></li>
                     <li><button class="tools__item icon--rect j-canvas-tool j-canvas-rect"></button></li>
                     <li><button class="tools__item icon--circle j-canvas-tool j-canvas-circle"></button></li>
                     <li><button class="tools__item icon--line j-canvas-tool j-canvas-line"></button></li>
                     <li><button class="tools__item icon--type j-canvas-tool j-canvas-type"></button></li>
                     <li><button class="tools__item icon--trash j-canvas-tool j-canvas-remove"></button></li>
                     <li><button class="tools__item icon--create j-canvas-tool j-canvas-undo"></button></li>
                  </ul>
               </div>

               <script>
                  var canvasWrapper = document.querySelector('.j-canvas');
                  var canvas = canvasWrapper.querySelector('canvas');
                  canvas.width = canvasWrapper.clientWidth;
                  canvas.height = canvas.width / (16/9);
                  canvas = new fabric.Canvas(canvas.id, {
                     selection: false,
                     defaultCursor: 'crosshair'
                  });
                  canvas.calcOffset();

                  var isMouseDown = false,
                      canvasTools = canvasWrapper.querySelectorAll('.j-canvas-tool'),
                      pointer,
                      obj;

                  var states = [JSON.stringify(canvas)];

                  canvas.on('object:added', function(e) {
                     if (!isMouseDown) {
                        if (states.length === 10) {
                           states.shift();
                        }
                        states.push(JSON.stringify(canvas));
                        console.log(states);
                     }
                  });

                  canvas.on('object:modified', function(e) {
                     if (!isMouseDown) {
                        if (states.length === 10) {
                           states.shift();
                        }
                        states.push(JSON.stringify(canvas));
                        console.log(states);
                     }
                  });

                  canvas.on('text:editing:exited', function(e) {
                     if (!e.target.text) {
                        canvas.remove(e.target);
                     } else {
                        canvas.fire('object:modified', { target: obj });
                     }
                  });

                  /*canvas.setBackgroundImage('img/icon/exams.svg', canvas.renderAll.bind(canvas), {
                     width: canvas.width,
                     height: canvas.height,
                     originX: 'left',
                     originY: 'top'
                  });*/

                  /*fabric.loadSVGFromURL('img/icon/exams.svg', function(objects, options) {
                     var obj = fabric.util.groupSVGElements(objects, options);
                     obj.set({
                        left: 0,
                        top: 0,
                        scaleX: canvas.width / obj.width,
                        scaleY: canvas.height / obj.height
                     });
                     obj.set('selectable', false);
                     canvas.add(obj).sendToBack(obj).renderAll();
                  });*/

                  var activateTool = function(toolHandler) {
                     if (!this.classList.contains('j-active')) {

                        for (var i = canvasTools.length; i--;) {
                           canvasTools[i].classList.remove('j-active');
                        }
                        this.classList.add('j-active');

                        canvas.deactivateAllWithDispatch();
                        canvas.selection = false;
                        canvas.getObjects().forEach(function(obj) {
                           obj.set({
                              editable: false,
                              selectable: false
                           });
                        });

                        canvas.isDrawingMode = false;
                        canvas.defaultCursor = 'crosshair';

                        canvas.off('mouse:down');
                        canvas.off('mouse:move');
                        canvas.off('mouse:up');

                        if (toolHandler) {
                           canvas.on('mouse:down', toolHandler.mouseDown);
                           canvas.on('mouse:move', toolHandler.mouseMove);
                           canvas.on('mouse:up', toolHandler.mouseUp);
                        }

                        canvas.renderAll();
                     }
                  }

                  var rectHandler = {
                     mouseDown: function(o) {
                        isMouseDown = true;
                        pointer = canvas.getPointer(o.e);
                        obj = new fabric.Rect({
                           strokeWidth: 2,
                           fill: 'rgba(255, 255, 255, .25)',
                           stroke: 'rgba(0, 0, 0, .75)',
                           originX: 'left',
                           originY: 'top',
                           top: pointer.y,
                           left: pointer.x,
                           selectable: false,
                           perPixelTargetFind: true
                        });
                        canvas.add(obj);
                     },
                     mouseMove: function(o) {
                        if (!isMouseDown) {
                           return;
                        }
                        var currentPointer = canvas.getPointer(o.e);
                        obj.set({
                           width: currentPointer.x - pointer.x,
                           height: currentPointer.y - pointer.y
                        });
                        canvas.renderAll();
                     },
                     mouseUp: function(o) {
                        isMouseDown = false;
                        canvas.fire('object:modified', { target: obj });
                     }
                  };

                  var circleHandler = {
                     mouseDown: function(o) {
                        isMouseDown = true;
                        pointer = canvas.getPointer(o.e);
                        obj = new fabric.Ellipse({
                           strokeWidth: 2,
                           fill: 'rgba(255, 255, 255, .25)',
                           stroke: 'rgba(0, 0, 0, .75)',
                           top: pointer.y,
                           left: pointer.x,
                           originY: 'top',
                           originX: 'left',
                           selectable: false,
                           rx: 1,
                           ry: 1,
                           perPixelTargetFind: true
                        });
                        canvas.add(obj);
                     },
                     mouseMove: function(o) {
                        if (!isMouseDown) {
                           return;
                        }
                        var currentPointer = canvas.getPointer(o.e);
                        obj.set({
                           rx: Math.abs(currentPointer.x - pointer.x),
                           ry: Math.abs(currentPointer.y - pointer.y)
                        });
                        canvas.renderAll();
                     },
                     mouseUp: function(o) {
                        isMouseDown = false;
                        obj.set({
                           width: obj.rx * 2,
                           height: obj.ry * 2,
                           top: obj.top - obj.ry + 1,
                           left: obj.left - obj.rx + 1
                        });
                        canvas.renderAll();
                        canvas.fire('object:modified', { target: obj });
                     }
                  };

                  var lineHandler = {
                     mouseDown: function(o) {
                        isMouseDown = true;
                        pointer = canvas.getPointer(o.e);
                        obj = new fabric.Line([pointer.x, pointer.y, pointer.x, pointer.y], {
                           strokeWidth: 2,
                           stroke: 'rgba(0, 0, 0, 0.75)',
                           originX: 'center',
                           originY: 'center',
                           selectable: false,
                           perPixelTargetFind: true
                        });
                        canvas.add(obj);
                     },
                     mouseMove: function(o) {
                        if (!isMouseDown) {
                           return;
                        }
                        pointer = canvas.getPointer(o.e);
                        obj.set({
                           x2: pointer.x,
                           y2: pointer.y
                        });
                        canvas.renderAll();
                     },
                     mouseUp: function(o) {
                        isMouseDown = false;
                        canvas.fire('object:modified', { target: obj });
                     }
                  };

                  var typeHandler = {
                     mouseDown: function(o) {
                        isMouseDown = true;
                        pointer = canvas.getPointer(o.e);
                        var isInsideTextObject = false;
                        canvas.getObjects().forEach(function(objOnCanvas) {
                           if (objOnCanvas.get('type') === 'i-text') {
                              var bounds = objOnCanvas.getBoundingRect();
                              if (
                                 pointer.x >= bounds.left
                                 && pointer.x <= bounds.left + bounds.width
                                 && pointer.y >= bounds.top
                                 && pointer.y <= bounds.top + bounds.height
                              ) {
                                 objOnCanvas.enterEditing();
                                 isInsideTextObject = true;
                                 obj = null;
                              }
                           }
                        });
                        if (!isInsideTextObject) {
                           obj = new fabric.IText('', {
                              fontFamily: 'Roboto',
                              selectable: false,
                              originX: 'center',
                              originY: 'center',
                              lockUniScaling: true,
                              textAlign: 'center',
                              fontSize: 24,
                              fontWeight: 300,
                              fill: 'rgba(0, 0, 0, 1)'
                           });
                        }
                     },
                     mouseMove: function() {},
                     mouseUp: function(o) {
                        isMouseDown = false;
                        if (obj) {
                           pointer = canvas.getPointer(o.e);
                           obj.set({
                              top: pointer.y,
                              left: pointer.x
                           });
                           canvas.add(obj);
                           canvas.setActiveObject(obj);
                           obj.enterEditing();
                           canvas.renderAll();
                        }
                     }
                  };

                  canvasWrapper.querySelector('.j-canvas-select').addEventListener('click', function() {
                     (activateTool.bind(this))(null);
                     canvas.selection = true;
                     canvas.getObjects().forEach(function(obj) {
                        obj.set({
                           selectable: true
                        });
                        obj.setCoords();
                     });
                     canvas.defaultCursor = 'default';
                  });

                  canvasWrapper.querySelector('.j-canvas-paint').addEventListener('click', function() {
                     (activateTool.bind(this))(null);
                     canvas.isDrawingMode = true;
                  });

                  canvasWrapper.querySelector('.j-canvas-rect').addEventListener('click', function() {
                     (activateTool.bind(this))(rectHandler);
                  });

                  canvasWrapper.querySelector('.j-canvas-circle').addEventListener('click', function() {
                     (activateTool.bind(this))(circleHandler);
                  });

                  canvasWrapper.querySelector('.j-canvas-line').addEventListener('click', function() {
                     (activateTool.bind(this))(lineHandler);
                  });

                  canvasWrapper.querySelector('.j-canvas-type').addEventListener('click', function() {
                     (activateTool.bind(this))(typeHandler);
                     canvas.getObjects().forEach(function(obj) {
                        if (obj.get('type') === 'i-text') {
                           obj.set({
                              selectable: true,
                              editable: true
                           });
                        }
                     });
                     canvas.defaultCursor = 'text';
                  });

                  canvasWrapper.querySelector('.j-canvas-undo').addEventListener('click', function() {
                     if (states.length > 1) {
                        canvas.getObjects().forEach(function(obj) {
                           canvas.remove(obj);
                        });
                        states.pop();
                        canvas.loadFromJSON(states.pop());
                        canvas.renderAll();
                     }
                  });

                  canvasWrapper.querySelector('.j-canvas-remove').addEventListener('click', function() {
                     if (canvas.getActiveObject()) {
                        canvas.remove(canvas.getActiveObject());
                     } else if (canvas.getActiveGroup()) {
                        canvas.getActiveGroup().forEachObject(function(obj) {
                           canvas.remove(obj);
                        });
                        canvas.discardActiveGroup();
                        canvas.renderAll();
                     }
                  });

               </script>

               <p>Necessitatibus, quidem, saepe aspernatur velit consequuntur provident nostrum qui ratione ipsum eum rerum blanditiis itaque praesentium eius fugiat voluptates tempora. Perspiciatis, vitae temporibus natus itaque ipsam reprehenderit corporis veniam quia.</p>

            </article>

         </section>

      </article>



   </section>

   <footer class="page-footer">



   </footer>

</div>
<script>
               var test = document.querySelector('.j-code');

               test.addEventListener('keydown', function(e) {

                  if (e.keyCode == 9) {
                     e.preventDefault();
                     document.execCommand('InsertHTML', false, '   ');
                  } else if (e.keyCode == 13) {
                     e.preventDefault();
                     document.execCommand('InsertHTML', false, '\n');
                  }
               });
               test.addEventListener('input', function(e) {
                  /*var code = this.firstChild;
                  var text = code.innerText;
                  code.innerText = text;
                  Prism.highlightElement(code);*/
               });
            </script>
</body>
</html>